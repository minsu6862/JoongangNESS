<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
	<div layout:fragment="content">

     <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold" style="color:#0a2342;">공지사항</h2>
        <!-- 글쓰기 버튼 -->
        <a th:href="@{/board/write}" class="btn btn-gold">글쓰기</a>
    </div>
    <table class="table table-hover">
        <thead class="table-dark">
            <tr class="text-center">
                <th>번호</th>
                <th style="width:60%">제목</th>
                <th>작성자</th>
                <th>조회수</th>
                <th>작성일시</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="notice, loop : ${paging}" class="text-center">
                <td th:text="${paging.getTotalElements - loop.index - (paging.number * paging.size)}"></td>
                <td class="text-start">
                    <a th:href="@{|/board/detail/${notice.id}|}" th:text="${notice.subject}" class="notice-link"></a>
                    <span class="text-danger small ms-2" th:if="${#lists.size(notice.commentList) > 0}" th:text="|[${#lists.size(notice.commentList)}]|"></span>
                </td>
                <td>
                	<span th:text="${notice.author != null ? notice.author.memberName : '익명의 사용자'}"></span>
                </td>
                <td>
				    <span th:text="${notice.hit}"></span>  <!-- hti -> hit 수정 -->
				</td>
                <td th:text="${#temporals.format(notice.createDate.atZone(T(java.time.ZoneId).of('UTC'))
                                                .withZoneSameInstant(T(java.time.ZoneId).of('Asia/Seoul')),
                                                'yyyy-MM-dd HH:mm')}">등록일</td>
            </tr>
        </tbody>
    </table>

    <!-- 페이징 -->
    <div th:if="${!paging.isEmpty()}">
        <ul class="pagination justify-content-center">
            <li class="page-item" th:classappend="${!paging.hasPrevious()} ? 'disabled'">
                <a class="page-link" href="javascript:void(0)" th:data-page="${paging.number-1}">
                <span>이전</span>
                </a>
            </li>
            <!-- 페이지 표시 시작 -->
            <li class="page-item" th:each="page : ${#numbers.sequence(0, paging.totalPages-1)}"
            	th:if="${page >= paging.number-2 && page <= paging.number+2}"
                th:classappend="${page == paging.number} ? 'active'">
                <a class="page-link" th:href="@{|?page=${page}&kw=${kw}|}" th:text="${page+1}"></a>
            </li>
            <li class="page-item" th:classappend="${!paging.hasNext()} ? 'disabled'">
                <a class="page-link" href="javascript:void(0)" th:data-page="${paging.number+1}">
                <span>다음</span>
                </a>
            </li>
        </ul>
    </div>
</div>
<script layout:fragment="script" type="text/javascript">
	const page_elements = document.getElementsByClassName("page-link");
	Array.from(page_elements).forEach(function (element) {
		element.addEventListener('click', function () {
		document.getElementById('page').value = this.dataset.page;	
			document.getElementById('searchForm').submit();
		});
	});
		
	const btn_search = document.getElementsByClassName("page-link");
	Array.from(page_elements).forEach(function (element) {
	element.addEventListener('click', function () {
				
		});
	});
</script>
</html>